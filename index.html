<!DOCTYPE html>
<html lang="pa">
<head>
<meta charset="UTF-8">
<title>Punjabi Calligraphy Poster Maker</title>
<style>
@font-face {
  font-family: 'Raavi';
  src: url('raavi.ttf');
}
@font-face {
  font-family: 'Gurblipi';
  src: url('gurbilipi.ttf');
}
@font-face {
  font-family: 'Prabhki';
  src: url('prabhki.ttf');
}
@font-face {
  font-family: 'GurbaniAkhar';
  src: url('GurbaniAkharHeavy.ttf');
}
</style>
</head>
<body>

<h1>Punjabi Calligraphy Poster Maker</h1>

<textarea id="textInput" placeholder="ਇੱਥੇ ਪੰਜਾਬੀ ਲਿਖੋ..."></textarea>

<div class="controls">
<select id="fontSelect">
<option value="Noto Serif Gurmukhi">Noto Serif</option>
<option value="serif">Serif</option>
<option value="cursive">Cursive</option>
</select>

<input type="color" id="textColor" value="#000000">
<input type="color" id="bgColor" value="#ffffff">

<br>
Font Size:
<input type="range" id="fontSize" min="20" max="120" value="50">

Shadow:
<input type="range" id="shadowSize" min="0" max="20" value="0">

<br>

Align:
<select id="align">
<option value="left">Left</option>
<option value="center">Center</option>
<option value="right">Right</option>
</select>

Word Art:
<select id="wordArt">
<option value="normal">Normal</option>
<option value="curve">Curve</option>
<option value="wave">Wave</option>
</select>

<br>

<button onclick="toggleBold()">Bold</button>
<button onclick="toggleUnderline()">Underline</button>

<br>

Border Color:
<input type="color" id="borderColor" value="#000000">
Border Size:
<input type="range" id="borderSize" min="0" max="20" value="0">

<br>

<button onclick="drawText()">Convert</button>
<button onclick="undo()">Undo</button>
<button onclick="clearCanvas()">Delete</button>
<button onclick="saveImage()">Save</button>
<button onclick="shareImage()">Share</button>
<button onclick="window.print()">Print</button>

<br>

<button onclick="zoomIn()">Zoom +</button>
<button onclick="zoomOut()">Zoom -</button>
<button onclick="toggleDraw()">Hand Work ✍️</button>
</div>

<canvas id="canvas" width="400" height="400"></canvas>
<script>
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");

let scale=1;
let bold=false;
let underline=false;
let drawMode=false;
let drawing=false;
let history=[];

function saveState(){
history.push(ctx.getImageData(0,0,canvas.width,canvas.height));
}

function undo(){
if(history.length>0){
ctx.putImageData(history.pop(),0,0);
}
}

function toggleBold(){bold=!bold;}
function toggleUnderline(){underline=!underline;}

function zoomIn(){scale+=0.1;drawText();}
function zoomOut(){scale=Math.max(0.2,scale-0.1);drawText();}
function toggleDraw(){drawMode=!drawMode;}

canvas.addEventListener("pointerdown",e=>{
if(drawMode){
drawing=true;
ctx.beginPath();
ctx.moveTo(e.offsetX,e.offsetY);
}
});
canvas.addEventListener("pointermove",e=>{
if(drawMode && drawing){
ctx.lineTo(e.offsetX,e.offsetY);
ctx.strokeStyle=document.getElementById("textColor").value;
ctx.lineWidth=3;
ctx.stroke();
}
});
canvas.addEventListener("pointerup",()=>drawing=false);

function clearCanvas(){
ctx.clearRect(0,0,canvas.width,canvas.height);
}

function wrapText(text,x,y,lineHeight){
const lines=text.split("\n");
lines.forEach((line,i)=>{
ctx.fillText(line,x,y+i*lineHeight);
if(underline){
let w=ctx.measureText(line).width;
ctx.fillRect(x,y+i*lineHeight+5,w,2);
}
});
}

function drawText(){
saveState();

const text=textInput.value;
const font=fontSelect.value;
const size=fontSize.value;
const tc=textColor.value;
const bg=bgColor.value;
const bc=borderColor.value;
const bs=borderSize.value;
const shadow=shadowSize.value;
const align=document.getElementById("align").value;
const art=document.getElementById("wordArt").value;

ctx.setTransform(1,0,0,1,0,0);
ctx.clearRect(0,0,canvas.width,canvas.height);
ctx.scale(scale,scale);

ctx.fillStyle=bg;
ctx.fillRect(0,0,canvas.width,canvas.height);

if(bs>0){
ctx.strokeStyle=bc;
ctx.lineWidth=bs;
ctx.strokeRect(0,0,canvas.width,canvas.height);
}

ctx.fillStyle=tc;
ctx.textAlign=align;
ctx.textBaseline="top";

let style="";
if(bold) style+="bold ";
ctx.font=style+size+"px "+font;

ctx.shadowColor="black";
ctx.shadowBlur=shadow;

let x=align=="left"?10:align=="center"?canvas.width/2:canvas.width-10;
let y=20;

wrapText(text,x,y,size+10);
}

function saveImage(){
const link=document.createElement("a");
link.download="poster.png";
link.href=canvas.toDataURL();
link.click();
}

function shareImage(){
canvas.toBlob(blob=>{
const file=new File([blob],"poster.png",{type:"image/png"});
if(navigator.share){
navigator.share({files:[file],title:"Poster"});
}
});
}
</script>

</body>
</html>
