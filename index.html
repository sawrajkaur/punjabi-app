<!DOCTYPE html>
<html lang="pa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Punjabi Calligraphy Poster Maker</title>

<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+Gurmukhi&family=Noto+Sans+Gurmukhi&family=Baloo+Paaji+2&family=Mukta+Mahee&family=Langar&family=Tiro+Gurmukhi&family=Anek+Gurmukhi&family=Changa&display=swap" rel="stylesheet">

<style>
@font-face { font-family:"Raavi"; src:url("raavi.ttf"); }
@font-face { font-family:"AnmolLipi"; src:url("AnmolLipi.ttf"); }
@font-face { font-family:"Prabhki"; src:url("Prabhki.ttf"); }

body{
  margin:0;
  font-family:sans-serif;
  background:linear-gradient(#efe6ff,#ffffff);
  text-align:center;
}
header{
  background:#5b2ca0;
  color:white;
  padding:12px;
  font-size:22px;
}
textarea{
  width:90%;
  margin:8px;
  padding:10px;
  font-size:18px;
  border-radius:10px;
  border:2px solid #5b2ca0;
}
.controls{
  background:white;
  margin:8px;
  padding:10px;
  border-radius:15px;
}
select,button,input{
  margin:4px;
  padding:6px 10px;
  border-radius:8px;
}
button{background:#5b2ca0;color:white;}
canvas{
  border:4px solid black;
  margin:10px auto;
  display:block;
  background:white;
  touch-action:none;
}
</style>
</head>

<body>
<header>Punjabi Calligraphy Poster Maker</header>

<textarea id="textInput" placeholder="ਇੱਥੇ ਪੰਜਾਬੀ ਲਿਖੋ (multiple lines allowed)"></textarea>

<div class="controls">

<button onclick="drawText()">Convert</button>
<button onclick="undo()">Undo</button>
<button onclick="clearCanvas()">Delete</button>
<button onclick="saveImage()">Save</button>
<button onclick="shareImage()">Share</button>
<button onclick="printImage()">Print</button>

<br><br>

<select id="fontSelect">
<option value="Noto Serif Gurmukhi">Noto Serif</option>
<option value="Noto Sans Gurmukhi">Noto Sans</option>
<option value="Baloo Paaji 2">Baloo</option>
<option value="Mukta Mahee">Mukta</option>
<option value="Langar">Langar</option>
<option value="Tiro Gurmukhi">Tiro</option>
<option value="Anek Gurmukhi">Anek</option>
<option value="Changa">Changa</option>
<option value="Raavi">Raavi</option>
<option value="AnmolLipi">Anmol</option>
<option value="Prabhki">Prabhki</option>
</select>

<input type="color" id="textColor" value="#000000">
<input type="color" id="bgColor" value="#ffffff">

<br>

Font Size:
<input type="range" id="fontSize" min="10" max="200" value="60">

Shadow:
<input type="range" id="shadowSize" min="0" max="40" value="0">

<br>

Align:
<select id="align">
<option value="left">Left</option>
<option value="center">Center</option>
<option value="right">Right</option>
</select>

Word Art:
<select id="wordArt">
<option value="normal">Normal</option>
<option value="shadow">Shadow</option>
<option value="outline">Outline</option>
<option value="glow">Glow</option>
<option value="gradient">Gradient</option>
<option value="curve">Curve</option>
</select>

<br>

<button onclick="toggleBold()">Bold</button>
<button onclick="toggleUnderline()">Underline</button>

<br>

Border Color <input type="color" id="borderColor" value="#000000">
Border Size <input type="range" id="borderSize" min="0" max="20" value="4">

<br><br>

<button onclick="zoomIn()">Zoom +</button>
<button onclick="zoomOut()">Zoom -</button>
<button onclick="toggleDraw()">Hand Work ✍️</button>

</div>

<canvas id="canvas" width="350" height="350"></canvas>

<script>
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");

let scale=1;
let bold=false;
let underline=false;
let history=[];
let drawMode=false;
let drawing=false;
document.getElementById("textInput").addEventListener("input", drawText);
document.getElementById("fontSelect").addEventListener("change", drawText);
document.getElementById("textColor").addEventListener("input", drawText);
document.getElementById("bgColor").addEventListener("input", drawText);
function saveState(){history.push(ctx.getImageData(0,0,canvas.width,canvas.height));
function undo(){
 if(history.length>0){
  const imgData = history.pop();
ctx.putImageData(imgData,0,0);
}

function toggleBold(){bold=!bold;}
function toggleUnderline(){underline=!underline;}
function zoomIn(){scale+=0.1; drawText();}
function zoomOut(){scale=Math.max(0.2,scale-0.1); drawText();}
function toggleDraw(){drawMode=!drawMode;}

canvas.addEventListener("pointerdown",e=>{
 if(drawMode){drawing=true;ctx.beginPath();ctx.moveTo(e.offsetX,e.offsetY);}
});
canvas.addEventListener("pointermove",e=>{
 if(drawMode && drawing){
  ctx.lineTo(e.offsetX,e.offsetY);
  ctx.strokeStyle=textColor.value;
  ctx.lineWidth=3;
  ctx.stroke();
 }
});
canvas.addEventListener("pointerup",()=>drawing=false);

function wrapText(text,x,y,lineHeight){
 const lines=text.split("\n");
 lines.forEach((line,i)=>{
  ctx.fillText(line,x,y+i*lineHeight);
 });
}
function drawText(){
  saveState();

  const text = textInput.value;
  const font = fontSelect.value;
  const size = fontSize.value;
  const tc = textColor.value;
  const bg = bgColor.value;
  const borderC = borderColor.value;
  const borderS = borderSize.value;
  const art = wordArt.value;
  const shadow = shadowSize.value;
  const align = document.getElementById("align").value;

  ctx.setTransform(1,0,0,1,0,0);
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.scale(scale, scale);

  // background
  ctx.fillStyle = bg;
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // border
  if(borderS > 0){
    ctx.strokeStyle = borderC;
    ctx.lineWidth = borderS;
    ctx.strokeRect(0,0,canvas.width,canvas.height);
  }

  // shadow
  ctx.shadowColor = tc;
  ctx.shadowBlur = shadow;

  // font
  ctx.fillStyle = tc;
  ctx.font = `${bold ? "bold" : ""} ${size}px ${font}`;
  ctx.textAlign = align;
  ctx.textBaseline = "middle";

  let x = canvas.width/2;
  if(align==="left") x = 20;
  if(align==="right") x = canvas.width-20;

  wrapText(text, x, canvas.height/2, size*1.3);
}

 ctx.setTransform(1,0,0,1,0,0);
ctx.clearRect(0,0,canvas.width,canvas.height);
ctx.scale(scale, scale);
 ctx.fillStyle=bg;
 ctx.fillRect(0,0,canvas.width,canvas.height);

 if(borderS>0){
  ctx.strokeStyle=borderC;
  ctx.lineWidth=borderS;
  ctx.strokeRect(0,0,canvas.width,canvas.height);
 }

 let style=(bold?"bold ":"")+size+"px "+font;
 ctx.font=style;
 ctx.textAlign=align;
 ctx.textBaseline="top";

 let x=canvas.width/2;
 if(align=="left") x=20;
 if(align=="right") x=canvas.width-20;

 if(art=="gradient"){
  let g=ctx.createLinearGradient(0,0,canvas.width,0);
  g.addColorStop(0,"red");
  g.addColorStop(1,"blue");
  ctx.fillStyle=g;
 } else {
  ctx.fillStyle=tc;
 }

 if(art=="shadow"||art=="glow"){
  ctx.shadowColor=tc;
  ctx.shadowBlur=shadow;
 } else {
  ctx.shadowBlur=0;
 }

 wrapText(text,x,40,size+10);

 if(underline){
  let y=40+size;
  ctx.beginPath();
  ctx.moveTo(20,y);
  ctx.lineTo(canvas.width-20,y);
  ctx.stroke();
 }
}

function clearCanvas(){ctx.clearRect(0,0,canvas.width,canvas.height);}
function saveImage(){
  const link = document.createElement("a");
  link.download = "poster.png";
  link.href = canvas.toDataURL("image/png");
  link.click();
}
function shareImage(){
  canvas.toBlob(blob=>{
    const file = new File([blob],"poster.png",{type:"image/png"});
    if(navigator.share){
      navigator.share({
        files:[file],
        title:"Punjabi Poster"
      });
    }else{
      alert("Share not supported");
    }
  });
}
function printImage(){
 const w=window.open("");
 w.document.write("<img src='"+canvas.toDataURL()+"' style='width:100%'>");
 w.print();
}
</script>

</body>
</html>
